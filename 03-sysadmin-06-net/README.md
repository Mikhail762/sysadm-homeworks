# Домашнее задание к занятию "3.6. Компьютерные сети, лекция 1"

1. Необязательное задание:
можно посмотреть целый фильм в консоли `telnet towel.blinkenlights.nl` :)

1. Узнайте о том, сколько действительно независимых (не пересекающихся) каналов есть в разделяемой среде WiFi при работе на 2.4 ГГц. Стандарты с полосой 5 ГГц более актуальны, но регламенты на 5 ГГц существенно различаются в разных странах, а так же не раз обновлялись. В качестве дополнительного вопроса вне зачета, попробуйте найти актуальный ответ и на этот вопрос.

Стандарт 802.11 b/g/n предполагает возможность использования трех гарантированно непересекающихся каналов шириной 22МГц. Если использовать 14 канал - то четырех, однако использование 14 канала незаконно во многих странах, и не поддерживается многими устройствами.
На частоте 5 ГГц можно выделить 23 непересекающихся канала по 20 МГц.

1. Адрес канального уровня – MAC адрес – это 6 байт, первые 3 из которых называются OUI – Organizationally Unique Identifier или уникальный идентификатор организации. Какому производителю принадлежит MAC `38:f9:d3:55:55:79`?

MAC-адреса в диапазоне 	38-F9-D3-00-00-00 - 38-F9-D3-FF-FF-FF используется в устройствах Apple, Inc.

1. Каким будет payload TCP сегмента, если Ethernet MTU задан в 9001 байт, размер заголовков IPv4 – 20 байт, а TCP – 32 байта?

9001 - 20 - 32 = 8949 байт

1. Может ли во флагах TCP одновременно быть установлены флаги SYN и FIN при штатном режиме работы сети? Почему да или нет?

В спецификации TCP установка этих флагов в одном сегменте не предусмотрена, и при штатной работе сети логически бессмысленна. Однако в базе CVE описаны атаки на файрвол и DDOS-атаки с помощью таких специально сконструированных пакетов. В современных версиях ядра linux и iptables эти уязвимости устранены.  

1. `ss -ula sport = :53` на хосте имеет следующий вывод:

```bash
State           Recv-Q          Send-Q                   Local Address:Port                     Peer Address:Port          Process
UNCONN          0               0                        127.0.0.53%lo:domain                        0.0.0.0:*
```

Почему в `State` присутствует только `UNCONN`, и может ли там присутствовать, например, `TIME-WAIT`?

UDP-порт не имеет статуса состояния, как у TCP. Утилита ss просто показывает, то порт открыт, но передача данных не идет.

7. Обладая знаниями о том, как штатным образом завершается соединение (FIN от инициатора, FIN-ACK от ответчика, ACK от инициатора), опишите в каких состояниях будет находиться TCP соединение в каждый момент времени на клиенте и на сервере при завершении. Схема переходов состояния соединения вам в этом поможет.

7.1 Статус клиента ESTABLISHED, клиент отправляет серверу пакет с флагом FIN, статус меняется на FIN_WAIT_1.  
7.2 Статус сервера ESTABLISHED, получив пакет с флагом FIN, переводит соединение в статус CLOSE_WAIT и отправляет в ответ ACK.
7.3 Клиент получает от сервера АCK, меняет статус соединения на FIN_WAIT_2.
7.4 Cервер, подождав возможных сигналов от приложения, отправляет пакет с флагом FIN и переводит соединение в LAST_ACK.
7.5 Клиент получает FIN, отправляет ACK, переходит в состояние TIME_WAIT.
7.6 Сервер получает последний ACK, переводит соединение в статус CLOSED.  
7.7 Клиент, прождав (время жизни сегмента)х2, переводит соединение в статус CLOSED.

1. TCP порт – 16 битное число. Предположим, 2 находящихся в одной сети хоста устанавливают между собой соединения. Каким будет теоретическое максимальное число соединений, ограниченное только лишь параметрами L4, которое параллельно может установить клиент с одного IP адреса к серверу с одним IP адресом? Сколько соединений сможет обслужить сервер от одного клиента? А если клиентов больше одного?

TCP соединения идентифицируются 4 числами: IP-адрес источника, порт источника, IP-адрес назначения, порт назначения. Адреса по условию не меняются, поэтому теоретически можно установить (число портов)^2 соединений: 2^16^2 = 4 294 967 296. Если клиентов больше, то число соединений нужно умножить на их число.

1. Может ли сложиться ситуация, при которой большое число соединений TCP на хосте находятся в состоянии  `TIME-WAIT`? Если да, то является ли она хорошей или плохой? Подкрепите свой ответ пояснением той или иной оценки.

Например, если клиент активно подключается/отключается к какому-то серверу. Если подключения происходят быстрее, чем освобождаются порты TIME_WAIT, то число последних будет расти, забирая системные ресурсы.  
На сервере растущее число портов TIME_WAIT также вынуждает тратить ресурсы на их обработку.

1. Чем особенно плоха фрагментация UDP относительно фрагментации TCP?

С увеличением числа пакетов с фрагментами датаграммы, увеличивается шанс потери одного из них, что приводит к недоставке самой датаграммы. Возможности повторной отправки по UDP нет.

1. Если бы вы строили систему удаленного сбора логов, то есть систему, в которой несколько хостов отправяют на центральный узел генерируемые приложениями логи (предположим, что логи – текстовая информация), какой протокол транспортного уровня вы выбрали бы и почему? Проверьте ваше предположение самостоятельно, узнав о стандартном протоколе syslog.

1. Сколько портов TCP находится в состоянии прослушивания на вашей виртуальной машине с Ubuntu, и каким процессам они принадлежат?

1. Какой ключ нужно добавить в `tcpdump`, чтобы он начал выводить не только заголовки, но и содержимое фреймов в текстовом виде? А в текстовом и шестнадцатиричном?

1. Попробуйте собрать дамп трафика с помощью `tcpdump` на основном интерфейсе вашей виртуальной машины и посмотреть его через tshark или Wireshark (можно ограничить число пакетов `-c 100`). Встретились ли вам какие-то установленные флаги Internet Protocol (не флаги TCP, а флаги IP)? Узнайте, какие флаги бывают. Как на самом деле называется стандарт Ethernet, фреймы которого попали в ваш дамп? Можно ли где-то в дампе увидеть OUI?

 
 ---

### Как оформить ДЗ?

Домашнее задание выполните в файле readme.md в github репозитории. В личном кабинете отправьте на проверку ссылку на .md-файл в вашем репозитории.

Также вы можете выполнить задание в [Google Docs](https://docs.google.com/document/u/0/?tgif=d) и отправить в личном кабинете на проверку ссылку на ваш документ.
Название файла Google Docs должно содержать номер лекции и фамилию студента. Пример названия: "1.1. Введение в DevOps — Сусанна Алиева"
Перед тем как выслать ссылку, убедитесь, что ее содержимое не является приватным (открыто на комментирование всем, у кого есть ссылка). 
Если необходимо прикрепить дополнительные ссылки, просто добавьте их в свой Google Docs.

Любые вопросы по решению задач задавайте в чате Slack.

---
